(ns multi-class-perceptron.core-test
  (:refer-clojure :exclude [load-file])
  (:use clojure.test
        multi-class-perceptron.core))

(deftest parse-line-test
  (is (= (parse-line "12 59:1 61:1 75:1 164:1 614:1 749:2 862:1 1350:1 2544:1 2664:1 3370:1 8394:1 9969:1 11627:1 13440:1 15567:1 17721:2 18446:1 19716:1 22116:1 28044:2 34282:2 38420:1 38622:1 38623:2 38854:2 39653:1 39654:1 39655:1 39656:1"))
      [12
       [[59 1] [61 1] [75 1] [164 1] [614 1] [749 2] [862 1] [1350 1]
        [2544 1] [2664 1] [3370 1] [8394 1] [9969 1] [11627 1] [13440 1]
        [15567 1] [17721 2] [18446 1] [19716 1] [22116 1] [28044 2]
        [34282 2] [38420 1] [38622 1] [38623 2] [38854 2] [39653 1]
        [39654 1] [39655 1] [39656 1]]]))

(deftest inner-product-test
  (is (= (inner-product {1 2, 2 1} [[1 1] [2 10] [3 2]])
         12.0)))

(deftest get-label-score-pairs-test
  (is (= (get-label-score-pairs
          {1 {1 2, 2 1}
           2 {}
           3 {1 2, 2 1, 3 10}}
          [[1 1] [2 10] [3 2]])
         [[1 12.0] [2 0.0] [3 32.0]])))

(deftest accuracy-test
  (is (= (accuracy [1 1 1 1] [2 2 1 2])
         0.25)))
